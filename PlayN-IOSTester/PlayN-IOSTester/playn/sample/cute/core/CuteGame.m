//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: core/src/main/java/playn/sample/cute/core/CuteGame.java
//
//  Created by Thomas on 7/25/13.
//

#include "IOSClass.h"
#include "IOSObjectArray.h"
#include "java/lang/Integer.h"
#include "java/lang/Math.h"
#include "java/lang/Throwable.h"
#include "java/util/HashMap.h"
#include "java/util/Map.h"
#include "playn/core/Assets.h"
#include "playn/core/Game.h"
#include "playn/core/Graphics.h"
#include "playn/core/GroupLayer.h"
#include "playn/core/Image.h"
#include "playn/core/ImmediateLayer.h"
#include "playn/core/Json.h"
#include "playn/core/Key.h"
#include "playn/core/Keyboard.h"
#include "playn/core/Net.h"
#include "playn/core/PlayN.h"
#include "playn/core/Pointer.h"
#include "playn/core/Surface.h"
#include "playn/sample/cute/core/CuteGame.h"
#include "playn/sample/cute/core/CuteObject.h"
#include "playn/sample/cute/core/CuteWorld.h"

@implementation PlaynSampleCuteCoreCuteGame

static id<JavaUtilMap> PlaynSampleCuteCoreCuteGame_ADD_TILE_KEYS_;

@synthesize gameLayer = gameLayer_;
@synthesize frameAlpha = frameAlpha_;
@synthesize world = world_;
@synthesize catGirl = catGirl_;
@synthesize stars = stars_;
@synthesize controlLeft = controlLeft_;
@synthesize controlRight = controlRight_;
@synthesize controlUp = controlUp_;
@synthesize controlDown = controlDown_;
@synthesize controlJump = controlJump_;
@synthesize touchVectorX = touchVectorX_;
@synthesize touchVectorY = touchVectorY_;

+ (id<JavaUtilMap>)ADD_TILE_KEYS {
  return PlaynSampleCuteCoreCuteGame_ADD_TILE_KEYS_;
}

+ (void)setADD_TILE_KEYS:(id<JavaUtilMap>)ADD_TILE_KEYS {
  PlaynSampleCuteCoreCuteGame_ADD_TILE_KEYS_ = ADD_TILE_KEYS;
}

- (id)init {
  return [super initWithInt:33];
}

- (void)init__ OBJC_METHOD_FAMILY_NONE {
  [((id<PlaynCoreKeyboard>) nil_chk([PlaynCorePlayN keyboard])) setListenerWithPlaynCoreKeyboard_Listener:self];
  [((id<PlaynCorePointer>) nil_chk([PlaynCorePlayN pointer])) setListenerWithPlaynCorePointer_Listener:[[PlaynSampleCuteCoreCuteGame_$1 alloc] initWithPlaynSampleCuteCoreCuteGame:self]];
  world_ = [[PlaynSampleCuteCoreCuteWorld alloc] initWithInt:16 withInt:16];
  for (int y = 0; y < 16; ++y) {
    for (int x = 0; x < 16; ++x) {
      [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:x withInt:y withInt:2];
    }
  }
  for (int i = 0; i < 2; ++i) {
    [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:4 withInt:4 withInt:7];
    [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:5 withInt:4 withInt:7];
    [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:6 withInt:4 withInt:7];
    [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:4 withInt:5 withInt:7];
    [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:5 withInt:5 withInt:7];
    [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:6 withInt:5 withInt:7];
    [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:4 withInt:6 withInt:7];
    [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:5 withInt:6 withInt:3];
    [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:6 withInt:6 withInt:7];
  }
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:4 withInt:4 withInt:19];
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:5 withInt:4 withInt:12];
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:6 withInt:4 withInt:13];
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:4 withInt:5 withInt:18];
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:5 withInt:5 withInt:5];
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:6 withInt:5 withInt:14];
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:4 withInt:6 withInt:17];
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:5 withInt:6 withInt:16];
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:6 withInt:6 withInt:15];
  gameLayer_ = [((id<PlaynCoreGraphics>) nil_chk([PlaynCorePlayN graphics])) createImmediateLayerWithPlaynCoreImmediateLayer_Renderer:[[PlaynSampleCuteCoreCuteGame_$2 alloc] initWithPlaynSampleCuteCoreCuteGame:self]];
  [((id<PlaynCoreGroupLayer>) nil_chk([((id<PlaynCoreGraphics>) nil_chk([PlaynCorePlayN graphics])) rootLayer])) addWithPlaynCoreLayer:gameLayer_];
  [self initStuff];
}

- (void)initStuff OBJC_METHOD_FAMILY_NONE {
  catGirl_ = [[PlaynSampleCuteCoreCuteObject alloc] initWithPlaynCoreImage:[((id<PlaynCoreAssets>) nil_chk([PlaynCorePlayN assets])) getImageWithNSString:@"images/character_cat_girl.png"]];
  [((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)) setPosWithDouble:2 withDouble:2 withDouble:1];
  ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).r = 0.3;
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addObjectWithPlaynSampleCuteCoreCuteObject:catGirl_];
  stars_ = [IOSObjectArray arrayWithLength:PlaynSampleCuteCoreCuteGame_NUM_STARS type:[IOSClass classWithClass:[PlaynSampleCuteCoreCuteObject class]]];
  for (int i = 0; i < PlaynSampleCuteCoreCuteGame_NUM_STARS; ++i) {
    (void) [((IOSObjectArray *) nil_chk(stars_)) replaceObjectAtIndex:i withObject:[[PlaynSampleCuteCoreCuteObject alloc] initWithPlaynCoreImage:[((id<PlaynCoreAssets>) nil_chk([PlaynCorePlayN assets])) getImageWithNSString:@"images/star.png"]]];
    [((PlaynSampleCuteCoreCuteObject *) nil_chk([((IOSObjectArray *) nil_chk(stars_)) objectAtIndex:i])) setPosWithDouble:[JavaLangMath random] * [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) worldWidth] withDouble:[JavaLangMath random] * [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) worldHeight] withDouble:10];
    [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addObjectWithPlaynSampleCuteCoreCuteObject:[((IOSObjectArray *) nil_chk(stars_)) objectAtIndex:i]];
  }
}

- (void)onKeyDownWithPlaynCoreKeyboard_Event:(id<PlaynCoreKeyboard_Event>)event {
  JavaLangInteger *tileIdx = [((id<JavaUtilMap>) nil_chk(PlaynSampleCuteCoreCuteGame_ADD_TILE_KEYS_)) getWithId:[((id<PlaynCoreKeyboard_Event>) nil_chk(event)) key]];
  if (tileIdx != nil) {
    [self addTileWithInt:(int) ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).x_ withInt:(int) ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).y_ withInt:[tileIdx intValue]];
    return;
  }
  switch ([[((id<PlaynCoreKeyboard_Event>) nil_chk(event)) key] ordinal]) {
    case PlaynCoreKey_SPACE:
    controlJump_ = YES;
    break;
    case PlaynCoreKey_ESCAPE:
    [self removeTopTileWithInt:(int) ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).x_ withInt:(int) ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).y_];
    break;
    case PlaynCoreKey_LEFT:
    controlLeft_ = YES;
    break;
    case PlaynCoreKey_UP:
    controlUp_ = YES;
    break;
    case PlaynCoreKey_RIGHT:
    controlRight_ = YES;
    break;
    case PlaynCoreKey_DOWN:
    controlDown_ = YES;
    break;
  }
}

- (void)onKeyTypedWithPlaynCoreKeyboard_TypedEvent:(id<PlaynCoreKeyboard_TypedEvent>)event {
}

- (void)onKeyUpWithPlaynCoreKeyboard_Event:(id<PlaynCoreKeyboard_Event>)event {
  switch ([[((id<PlaynCoreKeyboard_Event>) nil_chk(event)) key] ordinal]) {
    case PlaynCoreKey_LEFT:
    controlLeft_ = NO;
    break;
    case PlaynCoreKey_UP:
    controlUp_ = NO;
    break;
    case PlaynCoreKey_RIGHT:
    controlRight_ = NO;
    break;
    case PlaynCoreKey_DOWN:
    controlDown_ = NO;
    break;
  }
}

- (void)updateWithInt:(int)delta {
  if (world_ == nil) {
    return;
  }
  [((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)) setAccelerationWithDouble:0 withDouble:0 withDouble:0];
  if ([((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)) isResting]) {
    if (controlLeft_) {
      ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).ax = -1.0;
    }
    if (controlRight_) {
      ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).ax = 1.0;
    }
    if (controlUp_) {
      ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).ay = -1.0;
    }
    if (controlDown_) {
      ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).ay = 1.0;
    }
    ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).ax += touchVectorX_;
    ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).ay += touchVectorY_;
    if (controlJump_) {
      ((PlaynSampleCuteCoreCuteObject *) nil_chk(catGirl_)).vz = 0.2;
      controlJump_ = NO;
    }
  }
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) updatePhysicsWithDouble:delta / 1000.0f];
}

- (void)paintWithFloat:(float)alpha {
  frameAlpha_ = alpha;
}

- (void)touchMoveWithFloat:(float)x
                 withFloat:(float)y {
  float cx = [((id<PlaynCoreGraphics>) nil_chk([PlaynCorePlayN graphics])) width] / 2;
  float cy = [((id<PlaynCoreGraphics>) nil_chk([PlaynCorePlayN graphics])) height] / 2;
  touchVectorX_ = (x - cx) * 1.0f / cx;
  touchVectorY_ = (y - cy) * 1.0f / cy;
}

- (void)addTileWithInt:(int)x
               withInt:(int)y
               withInt:(int)type {
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) addTileWithInt:x withInt:y withInt:type];
  id<PlaynCoreJson_Writer> w = [((id<PlaynCoreJson>) nil_chk([PlaynCorePlayN json])) newWriter];
  (void) [((id<PlaynCoreJson_Writer>) nil_chk(w)) object];
  (void) [((id<PlaynCoreJson_Writer>) nil_chk(w)) valueWithNSString:@"op" withNSString:@"addTop"];
  (void) [((id<PlaynCoreJson_Writer>) nil_chk(w)) valueWithNSString:@"x" withNSNumber:[JavaLangInteger valueOfWithInt:x]];
  (void) [((id<PlaynCoreJson_Writer>) nil_chk(w)) valueWithNSString:@"y" withNSNumber:[JavaLangInteger valueOfWithInt:y]];
  (void) [((id<PlaynCoreJson_Writer>) nil_chk(w)) valueWithNSString:@"type" withNSNumber:[JavaLangInteger valueOfWithInt:type]];
  (void) [((id<PlaynCoreJson_Writer>) nil_chk(w)) end];
  [self postWithNSString:[((id<PlaynCoreJson_Writer>) nil_chk(w)) write]];
}

- (void)removeTopTileWithInt:(int)x
                     withInt:(int)y {
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(world_)) removeTopTileWithInt:x withInt:y];
  id<PlaynCoreJson_Writer> w = [((id<PlaynCoreJson>) nil_chk([PlaynCorePlayN json])) newWriter];
  (void) [((id<PlaynCoreJson_Writer>) nil_chk(w)) object];
  (void) [((id<PlaynCoreJson_Writer>) nil_chk(w)) valueWithNSString:@"op" withNSString:@"removeTop"];
  (void) [((id<PlaynCoreJson_Writer>) nil_chk(w)) valueWithNSString:@"x" withNSNumber:[JavaLangInteger valueOfWithInt:x]];
  (void) [((id<PlaynCoreJson_Writer>) nil_chk(w)) valueWithNSString:@"y" withNSNumber:[JavaLangInteger valueOfWithInt:y]];
  (void) [((id<PlaynCoreJson_Writer>) nil_chk(w)) end];
  [self postWithNSString:[((id<PlaynCoreJson_Writer>) nil_chk(w)) write]];
}

- (void)postWithNSString:(NSString *)payload {
  [((id<PlaynCoreNet>) nil_chk([PlaynCorePlayN net])) postWithNSString:@"/rpc" withNSString:payload withPlaynCoreUtilCallback:[[PlaynSampleCuteCoreCuteGame_$3 alloc] init]];
}

+ (void)initialize {
  if (self == [PlaynSampleCuteCoreCuteGame class]) {
    PlaynSampleCuteCoreCuteGame_ADD_TILE_KEYS_ = [[JavaUtilHashMap alloc] init];
    {
      int idx = 0;
      {
        IOSObjectArray *a__ = [IOSObjectArray arrayWithObjects:(id[]){ [PlaynCoreKeyEnum K1], [PlaynCoreKeyEnum K2], [PlaynCoreKeyEnum K3], [PlaynCoreKeyEnum K4], [PlaynCoreKeyEnum K5], [PlaynCoreKeyEnum K6], [PlaynCoreKeyEnum K7], [PlaynCoreKeyEnum K8], [PlaynCoreKeyEnum W], [PlaynCoreKeyEnum D], [PlaynCoreKeyEnum S], [PlaynCoreKeyEnum A], [PlaynCoreKeyEnum T], [PlaynCoreKeyEnum Y], [PlaynCoreKeyEnum H], [PlaynCoreKeyEnum N], [PlaynCoreKeyEnum B], [PlaynCoreKeyEnum V], [PlaynCoreKeyEnum F], [PlaynCoreKeyEnum R] } count:20 type:[IOSClass classWithClass:[PlaynCoreKeyEnum class]]];
        int n__ = (int) [((IOSObjectArray *) nil_chk(a__)) count];
        for (int i__ = 0; i__ < n__; i__++) {
          PlaynCoreKeyEnum *key = [((IOSObjectArray *) nil_chk(a__)) objectAtIndex:i__];
          (void) [((id<JavaUtilMap>) nil_chk(PlaynSampleCuteCoreCuteGame_ADD_TILE_KEYS_)) putWithId:key withId:[JavaLangInteger valueOfWithInt:idx++]];
        }
      }
    }
  }
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  PlaynSampleCuteCoreCuteGame *typedCopy = (PlaynSampleCuteCoreCuteGame *) copy;
  typedCopy.gameLayer = gameLayer_;
  typedCopy.frameAlpha = frameAlpha_;
  typedCopy.world = world_;
  typedCopy.catGirl = catGirl_;
  typedCopy.stars = stars_;
  typedCopy.controlLeft = controlLeft_;
  typedCopy.controlRight = controlRight_;
  typedCopy.controlUp = controlUp_;
  typedCopy.controlDown = controlDown_;
  typedCopy.controlJump = controlJump_;
  typedCopy.touchVectorX = touchVectorX_;
  typedCopy.touchVectorY = touchVectorY_;
}

@end
@implementation PlaynSampleCuteCoreCuteGame_$1

@synthesize this$0 = this$0_;

- (void)onPointerEndWithPlaynCorePointer_Event:(id<PlaynCorePointer_Event>)event {
  this$0_.touchVectorX = this$0_.touchVectorY = 0;
}

- (void)onPointerCancelWithPlaynCorePointer_Event:(id<PlaynCorePointer_Event>)event {
  this$0_.touchVectorX = this$0_.touchVectorY = 0;
}

- (void)onPointerDragWithPlaynCorePointer_Event:(id<PlaynCorePointer_Event>)event {
  [this$0_ touchMoveWithFloat:[((id<PlaynCorePointer_Event>) nil_chk(event)) x] withFloat:[((id<PlaynCorePointer_Event>) nil_chk(event)) y]];
}

- (void)onPointerStartWithPlaynCorePointer_Event:(id<PlaynCorePointer_Event>)event {
  [this$0_ touchMoveWithFloat:[((id<PlaynCorePointer_Event>) nil_chk(event)) x] withFloat:[((id<PlaynCorePointer_Event>) nil_chk(event)) y]];
}

- (id)initWithPlaynSampleCuteCoreCuteGame:(PlaynSampleCuteCoreCuteGame *)outer$ {
  if ((self = [super init])) {
    this$0_ = outer$;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  PlaynSampleCuteCoreCuteGame_$1 *typedCopy = (PlaynSampleCuteCoreCuteGame_$1 *) copy;
  typedCopy.this$0 = this$0_;
}

@end
@implementation PlaynSampleCuteCoreCuteGame_$2

@synthesize this$0 = this$0_;

- (void)renderWithPlaynCoreSurface:(id<PlaynCoreSurface>)surface {
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(this$0_.world)) setViewOriginWithDouble:[((PlaynSampleCuteCoreCuteObject *) nil_chk(this$0_.catGirl)) xWithDouble:this$0_.frameAlpha] withDouble:[((PlaynSampleCuteCoreCuteObject *) nil_chk(this$0_.catGirl)) yWithDouble:this$0_.frameAlpha] withDouble:[((PlaynSampleCuteCoreCuteObject *) nil_chk(this$0_.catGirl)) zWithDouble:this$0_.frameAlpha]];
  (void) [((id<PlaynCoreSurface>) nil_chk(surface)) clear];
  [((PlaynSampleCuteCoreCuteWorld *) nil_chk(this$0_.world)) paintWithPlaynCoreSurface:surface withFloat:this$0_.frameAlpha];
}

- (id)initWithPlaynSampleCuteCoreCuteGame:(PlaynSampleCuteCoreCuteGame *)outer$ {
  if ((self = [super init])) {
    this$0_ = outer$;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  PlaynSampleCuteCoreCuteGame_$2 *typedCopy = (PlaynSampleCuteCoreCuteGame_$2 *) copy;
  typedCopy.this$0 = this$0_;
}

@end
@implementation PlaynSampleCuteCoreCuteGame_$3

- (void)onSuccessWithId:(NSString *)response {
}

- (void)onFailureWithJavaLangThrowable:(JavaLangThrowable *)error {
}

- (id)init {
  return [super init];
}

@end
