//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: core/src/main/java/tuxkids/tuxblocks/core/ImageLayerTintable.java
//
//  Created by Thomas on 7/25/13.
//

#include "IOSClass.h"
#include "java/lang/Integer.h"
#include "java/lang/Throwable.h"
#include "java/util/HashMap.h"
#include "playn/core/Connection.h"
#include "playn/core/Graphics.h"
#include "playn/core/GroupLayer.h"
#include "playn/core/Image.h"
#include "playn/core/ImageLayer.h"
#include "playn/core/Layer.h"
#include "playn/core/Pointer.h"
#include "playn/core/gl/GLContext.h"
#include "tripleplay/particle/GLStatus.h"
#include "tripleplay/util/Colors.h"
#include "tuxkids/tuxblocks/core/ImageLayerTintable.h"
#include "tuxkids/tuxblocks/core/PlayNObject.h"
#include "tuxkids/tuxblocks/core/utils/CanvasUtils.h"

@implementation TuxkidsTuxblocksCoreImageLayerTintable

static BOOL TuxkidsTuxblocksCoreImageLayerTintable_DISABLE_GL_;

@synthesize layer_ = layer__;
@synthesize baseImage = baseImage_;
@synthesize base = base_;
@synthesize top = top_;
@synthesize tint_ = tint__;
@synthesize tintMap = tintMap_;

+ (BOOL)DISABLE_GL {
  return TuxkidsTuxblocksCoreImageLayerTintable_DISABLE_GL_;
}

- (BOOL)useGL {
  return !TuxkidsTuxblocksCoreImageLayerTintable_DISABLE_GL_ && [((id<PlaynCoreGraphics>) nil_chk([TuxkidsTuxblocksCorePlayNObject graphics])) ctx] != nil;
}

- (float)width {
  return [((id<PlaynCoreImageLayer>) nil_chk(base_)) width];
}

- (float)height {
  return [((id<PlaynCoreImageLayer>) nil_chk(base_)) height];
}

- (id<PlaynCoreLayer>)layer {
  return layer__;
}

- (id<PlaynCoreImage>)image {
  return baseImage_;
}

- (float)tx {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) tx];
}

- (float)ty {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) ty];
}

- (int)tint {
  return tint__;
}

- (float)depth {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) depth];
}

- (float)alpha {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) alpha];
}

- (BOOL)visible {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) visible];
}

- (float)originX {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) originX];
}

- (float)originY {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) originY];
}

- (float)rotation {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) rotation];
}

- (void)setTxWithFloat:(float)tx {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) setTxWithFloat:tx];
}

- (void)setTyWithFloat:(float)ty {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) setTyWithFloat:ty];
}

- (void)setTranslationWithFloat:(float)x
                      withFloat:(float)y {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) setTranslationWithFloat:x withFloat:y];
}

- (void)setOriginWithFloat:(float)x
                 withFloat:(float)y {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) setOriginWithFloat:x withFloat:y];
}

- (void)setImageWithPlaynCoreImage:(id<PlaynCoreImage>)image {
  if (baseImage_ == image) return;
  self.baseImage = image;
  (void) [((id<PlaynCoreImageLayer>) nil_chk(base_)) setImageWithPlaynCoreImage:image];
  [((JavaUtilHashMap *) nil_chk(tintMap_)) clear];
  (void) [((JavaUtilHashMap *) nil_chk(tintMap_)) putWithId:[JavaLangInteger valueOfWithInt:[TripleplayUtilColors WHITE]] withId:image];
  [self setTintWithInt:tint__];
}

- (void)setScaleWithFloat:(float)scale_ {
  [self setScaleWithFloat:scale_ withFloat:scale_];
}

- (void)setScaleWithFloat:(float)scaleX
                withFloat:(float)scaleY {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) setScaleWithFloat:scaleX withFloat:scaleY];
}

- (void)setDepthWithFloat:(float)depth {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) setDepthWithFloat:depth];
}

- (void)setVisibleWithBOOL:(BOOL)visible {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) setVisibleWithBOOL:visible];
}

- (void)setAlphaWithFloat:(float)alpha {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) setAlphaWithFloat:alpha];
}

- (void)setRotationWithFloat:(float)angle {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) setRotationWithFloat:angle];
}

- (id)init {
  return [self initTuxkidsTuxblocksCoreImageLayerTintableWithPlaynCoreImage:nil];
}

- (id)initTuxkidsTuxblocksCoreImageLayerTintableWithPlaynCoreImage:(id<PlaynCoreImage>)image {
  if ((self = [super init])) {
    tintMap_ = [[JavaUtilHashMap alloc] init];
    layer__ = [((id<PlaynCoreGraphics>) nil_chk([TuxkidsTuxblocksCorePlayNObject graphics])) createGroupLayer];
    base_ = [((id<PlaynCoreGraphics>) nil_chk([TuxkidsTuxblocksCorePlayNObject graphics])) createImageLayerWithPlaynCoreImage:image];
    top_ = [((id<PlaynCoreGraphics>) nil_chk([TuxkidsTuxblocksCorePlayNObject graphics])) createImageLayer];
    (void) [((id<PlaynCoreImageLayer>) nil_chk(top_)) setInteractiveWithBOOL:NO];
    [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) addWithPlaynCoreLayer:base_];
    [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) addWithPlaynCoreLayer:top_];
    baseImage_ = image;
    (void) [((JavaUtilHashMap *) nil_chk(tintMap_)) putWithId:[JavaLangInteger valueOfWithInt:[TripleplayUtilColors WHITE]] withId:baseImage_];
    tint__ = [TripleplayUtilColors WHITE];
  }
  return self;
}

- (id)initWithPlaynCoreImage:(id<PlaynCoreImage>)image {
  return [self initTuxkidsTuxblocksCoreImageLayerTintableWithPlaynCoreImage:image];
}

- (void)setTintWithInt:(int)color {
  tint__ = color;
  if (![self useGL]) {
    (void) [((id<PlaynCoreImageLayer>) nil_chk(top_)) setImageWithPlaynCoreImage:nil];
    if (baseImage_ == nil) return;
    [((id<PlaynCoreImage>) nil_chk(baseImage_)) addCallbackWithPlaynCoreUtilCallback:[[TuxkidsTuxblocksCoreImageLayerTintable_$1 alloc] initWithTuxkidsTuxblocksCoreImageLayerTintable:self withInt:color]];
  }
  else {
    (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) setTintWithInt:color];
  }
}

- (void)setTintWithInt:(int)baseColor
               withInt:(int)tintColor
             withFloat:(float)perc {
  tint__ = [TripleplayUtilColors blendWithInt:baseColor withInt:tintColor withFloat:perc];
  if (![self useGL]) {
    [((id<PlaynCoreImage>) nil_chk(baseImage_)) addCallbackWithPlaynCoreUtilCallback:[[TuxkidsTuxblocksCoreImageLayerTintable_$2 alloc] initWithTuxkidsTuxblocksCoreImageLayerTintable:self withInt:baseColor withInt:tintColor]];
    (void) [((id<PlaynCoreImageLayer>) nil_chk(top_)) setAlphaWithFloat:1 - perc];
  }
  else {
    (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) setTintWithInt:[TripleplayUtilColors blendWithInt:baseColor withInt:tintColor withFloat:perc]];
  }
}

- (id<PlaynCoreImage>)getTintedImageWithJavaLangInteger:(JavaLangInteger *)color {
  id<PlaynCoreImage> mapped = [((JavaUtilHashMap *) nil_chk(tintMap_)) getWithId:color];
  if (mapped == nil) {
    mapped = [TuxkidsTuxblocksCoreUtilsCanvasUtils tintImageWithPlaynCoreImage:baseImage_ withInt:[((JavaLangInteger *) nil_chk(color)) intValue] withFloat:1];
    (void) [((JavaUtilHashMap *) nil_chk(tintMap_)) putWithId:color withId:mapped];
  }
  return mapped;
}

- (void)destroy {
  [((id<PlaynCoreGroupLayer>) nil_chk(layer__)) destroy];
}

- (void)addListenerWithPlaynCorePointer_Listener:(id<PlaynCorePointer_Listener>)pointerListener {
  (void) [((id<PlaynCoreImageLayer>) nil_chk(base_)) addListenerWithPlaynCorePointer_Listener:pointerListener];
}

+ (void)initialize {
  if (self == [TuxkidsTuxblocksCoreImageLayerTintable class]) {
    TuxkidsTuxblocksCoreImageLayerTintable_DISABLE_GL_ = ![TripleplayParticleGLStatus enabled];
  }
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TuxkidsTuxblocksCoreImageLayerTintable *typedCopy = (TuxkidsTuxblocksCoreImageLayerTintable *) copy;
  typedCopy.layer_ = layer__;
  typedCopy.baseImage = baseImage_;
  typedCopy.base = base_;
  typedCopy.top = top_;
  typedCopy.tint_ = tint__;
  typedCopy.tintMap = tintMap_;
}

@end
@implementation TuxkidsTuxblocksCoreImageLayerTintable_$1

@synthesize this$0 = this$0_;
@synthesize val$color = val$color_;

- (void)onSuccessWithId:(id<PlaynCoreImage>)result {
  (void) [((id<PlaynCoreImageLayer>) nil_chk(this$0_.base)) setImageWithPlaynCoreImage:[this$0_ getTintedImageWithJavaLangInteger:[JavaLangInteger valueOfWithInt:val$color_]]];
}

- (void)onFailureWithJavaLangThrowable:(JavaLangThrowable *)cause {
}

- (id)initWithTuxkidsTuxblocksCoreImageLayerTintable:(TuxkidsTuxblocksCoreImageLayerTintable *)outer$
                                             withInt:(int)capture$0 {
  if ((self = [super init])) {
    this$0_ = outer$;
    val$color_ = capture$0;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TuxkidsTuxblocksCoreImageLayerTintable_$1 *typedCopy = (TuxkidsTuxblocksCoreImageLayerTintable_$1 *) copy;
  typedCopy.this$0 = this$0_;
  typedCopy.val$color = val$color_;
}

@end
@implementation TuxkidsTuxblocksCoreImageLayerTintable_$2

@synthesize this$0 = this$0_;
@synthesize val$baseColor = val$baseColor_;
@synthesize val$tintColor = val$tintColor_;

- (void)onSuccessWithId:(id<PlaynCoreImage>)result {
  (void) [((id<PlaynCoreImageLayer>) nil_chk(this$0_.base)) setImageWithPlaynCoreImage:[this$0_ getTintedImageWithJavaLangInteger:[JavaLangInteger valueOfWithInt:val$baseColor_]]];
  (void) [((id<PlaynCoreImageLayer>) nil_chk(this$0_.top)) setImageWithPlaynCoreImage:[this$0_ getTintedImageWithJavaLangInteger:[JavaLangInteger valueOfWithInt:val$tintColor_]]];
}

- (void)onFailureWithJavaLangThrowable:(JavaLangThrowable *)cause {
}

- (id)initWithTuxkidsTuxblocksCoreImageLayerTintable:(TuxkidsTuxblocksCoreImageLayerTintable *)outer$
                                             withInt:(int)capture$0
                                             withInt:(int)capture$1 {
  if ((self = [super init])) {
    this$0_ = outer$;
    val$baseColor_ = capture$0;
    val$tintColor_ = capture$1;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TuxkidsTuxblocksCoreImageLayerTintable_$2 *typedCopy = (TuxkidsTuxblocksCoreImageLayerTintable_$2 *) copy;
  typedCopy.this$0 = this$0_;
  typedCopy.val$baseColor = val$baseColor_;
  typedCopy.val$tintColor = val$tintColor_;
}

@end
