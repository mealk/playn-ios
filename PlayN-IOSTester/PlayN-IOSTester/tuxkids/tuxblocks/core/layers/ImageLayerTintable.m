//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: core/src/main/java/tuxkids/tuxblocks/core/layers/ImageLayerTintable.java
//
//  Created by Thomas on 7/26/13.
//

#include "IOSClass.h"
#include "java/lang/Integer.h"
#include "java/lang/Throwable.h"
#include "java/util/HashMap.h"
#include "playn/core/Connection.h"
#include "playn/core/Graphics.h"
#include "playn/core/GroupLayer.h"
#include "playn/core/Image.h"
#include "playn/core/ImageLayer.h"
#include "playn/core/Layer.h"
#include "playn/core/Pointer.h"
#include "tripleplay/particle/GLStatus.h"
#include "tripleplay/util/Colors.h"
#include "tuxkids/tuxblocks/core/PlayNObject.h"
#include "tuxkids/tuxblocks/core/layers/ImageLayerTintable.h"
#include "tuxkids/tuxblocks/core/utils/CanvasUtils.h"

@implementation TuxkidsTuxblocksCoreLayersImageLayerTintable

@synthesize layer = layer_;
@synthesize baseImage = baseImage_;
@synthesize base = base_;
@synthesize top = top_;
@synthesize tint_ = tint__;
@synthesize tintMap = tintMap_;

- (BOOL)useGL {
  return [TripleplayParticleGLStatus enabled];
}

- (id<PlaynCoreGroupLayer>)parent {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) parent];
}

- (float)width {
  return [((id<PlaynCoreImageLayer>) nil_chk(base_)) width];
}

- (float)height {
  return [((id<PlaynCoreImageLayer>) nil_chk(base_)) height];
}

- (id<PlaynCoreLayer>)layerAddable {
  return layer_;
}

- (id<PlaynCoreImage>)image {
  return baseImage_;
}

- (float)tx {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) tx];
}

- (float)ty {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) ty];
}

- (int)tint {
  return tint__;
}

- (float)depth {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) depth];
}

- (float)alpha {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) alpha];
}

- (BOOL)visible {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) visible];
}

- (float)originX {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) originX];
}

- (float)originY {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) originY];
}

- (float)rotation {
  return [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) rotation];
}

- (void)setTxWithFloat:(float)tx {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setTxWithFloat:tx];
}

- (void)setTyWithFloat:(float)ty {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setTyWithFloat:ty];
}

- (void)setTranslationWithFloat:(float)x
                      withFloat:(float)y {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setTranslationWithFloat:x withFloat:y];
}

- (void)setOriginWithFloat:(float)x
                 withFloat:(float)y {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setOriginWithFloat:x withFloat:y];
}

- (void)setImageWithPlaynCoreImage:(id<PlaynCoreImage>)image {
  if (baseImage_ == image) return;
  self.baseImage = image;
  (void) [((id<PlaynCoreImageLayer>) nil_chk(base_)) setImageWithPlaynCoreImage:image];
  [((JavaUtilHashMap *) nil_chk(tintMap_)) clear];
  (void) [((JavaUtilHashMap *) nil_chk(tintMap_)) putWithId:[JavaLangInteger valueOfWithInt:[TripleplayUtilColors WHITE]] withId:image];
  [self setTintWithInt:tint__];
}

- (void)setScaleWithFloat:(float)scale_ {
  [self setScaleWithFloat:scale_ withFloat:scale_];
}

- (void)setScaleWithFloat:(float)scaleX
                withFloat:(float)scaleY {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setScaleWithFloat:scaleX withFloat:scaleY];
}

- (void)setDepthWithFloat:(float)depth {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setDepthWithFloat:depth];
}

- (void)setVisibleWithBOOL:(BOOL)visible {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setVisibleWithBOOL:visible];
}

- (void)setAlphaWithFloat:(float)alpha {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setAlphaWithFloat:alpha];
}

- (void)setRotationWithFloat:(float)angle {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setRotationWithFloat:angle];
}

- (void)setSizeWithFloat:(float)width
               withFloat:(float)height {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setScaleWithFloat:width / [((id<PlaynCoreImage>) nil_chk(baseImage_)) width] withFloat:height / [((id<PlaynCoreImage>) nil_chk(baseImage_)) height]];
}

- (void)setWidthWithFloat:(float)width {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setScaleXWithFloat:width / [((id<PlaynCoreImage>) nil_chk(baseImage_)) width]];
}

- (void)setHeightWithFloat:(float)height {
  (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setScaleYWithFloat:height / [((id<PlaynCoreImage>) nil_chk(baseImage_)) height]];
}

- (id)init {
  return [self initTuxkidsTuxblocksCoreLayersImageLayerTintableWithPlaynCoreImage:nil];
}

- (id)initTuxkidsTuxblocksCoreLayersImageLayerTintableWithPlaynCoreImage:(id<PlaynCoreImage>)image {
  if ((self = [super init])) {
    tintMap_ = [[JavaUtilHashMap alloc] init];
    layer_ = [((id<PlaynCoreGraphics>) nil_chk([TuxkidsTuxblocksCorePlayNObject graphics])) createGroupLayer];
    base_ = [((id<PlaynCoreGraphics>) nil_chk([TuxkidsTuxblocksCorePlayNObject graphics])) createImageLayerWithPlaynCoreImage:image];
    top_ = [((id<PlaynCoreGraphics>) nil_chk([TuxkidsTuxblocksCorePlayNObject graphics])) createImageLayer];
    (void) [((id<PlaynCoreImageLayer>) nil_chk(top_)) setInteractiveWithBOOL:NO];
    [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) addWithPlaynCoreLayer:base_];
    [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) addWithPlaynCoreLayer:top_];
    baseImage_ = image;
    (void) [((JavaUtilHashMap *) nil_chk(tintMap_)) putWithId:[JavaLangInteger valueOfWithInt:[TripleplayUtilColors WHITE]] withId:baseImage_];
    tint__ = [TripleplayUtilColors WHITE];
  }
  return self;
}

- (id)initWithPlaynCoreImage:(id<PlaynCoreImage>)image {
  return [self initTuxkidsTuxblocksCoreLayersImageLayerTintableWithPlaynCoreImage:image];
}

- (void)setTintWithInt:(int)color {
  tint__ = color;
  if (![self useGL]) {
    (void) [((id<PlaynCoreImageLayer>) nil_chk(top_)) setImageWithPlaynCoreImage:nil];
    if (baseImage_ == nil) return;
    [((id<PlaynCoreImage>) nil_chk(baseImage_)) addCallbackWithPlaynCoreUtilCallback:[[TuxkidsTuxblocksCoreLayersImageLayerTintable_$1 alloc] initWithTuxkidsTuxblocksCoreLayersImageLayerTintable:self withInt:color]];
  }
  else {
    (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setTintWithInt:color];
  }
}

- (void)setTintWithInt:(int)baseColor
               withInt:(int)tintColor
             withFloat:(float)perc {
  tint__ = [TripleplayUtilColors blendWithInt:baseColor withInt:tintColor withFloat:perc];
  if (![self useGL]) {
    [((id<PlaynCoreImage>) nil_chk(baseImage_)) addCallbackWithPlaynCoreUtilCallback:[[TuxkidsTuxblocksCoreLayersImageLayerTintable_$2 alloc] initWithTuxkidsTuxblocksCoreLayersImageLayerTintable:self withInt:baseColor withInt:tintColor]];
    (void) [((id<PlaynCoreImageLayer>) nil_chk(top_)) setAlphaWithFloat:1 - perc];
  }
  else {
    (void) [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) setTintWithInt:[TripleplayUtilColors blendWithInt:baseColor withInt:tintColor withFloat:perc]];
  }
}

- (id<PlaynCoreImage>)getTintedImageWithJavaLangInteger:(JavaLangInteger *)color {
  id<PlaynCoreImage> mapped = [((JavaUtilHashMap *) nil_chk(tintMap_)) getWithId:color];
  if (mapped == nil) {
    mapped = [TuxkidsTuxblocksCoreUtilsCanvasUtils tintImageWithPlaynCoreImage:baseImage_ withInt:[((JavaLangInteger *) nil_chk(color)) intValue] withFloat:1];
    (void) [((JavaUtilHashMap *) nil_chk(tintMap_)) putWithId:color withId:mapped];
  }
  return mapped;
}

- (void)destroy {
  [((id<PlaynCoreGroupLayer>) nil_chk(layer_)) destroy];
}

- (void)addListenerWithPlaynCorePointer_Listener:(id<PlaynCorePointer_Listener>)pointerListener {
  (void) [((id<PlaynCoreImageLayer>) nil_chk(base_)) addListenerWithPlaynCorePointer_Listener:pointerListener];
}

- (void)setInteractiveWithBOOL:(BOOL)interactive {
  (void) [((id<PlaynCoreImageLayer>) nil_chk(base_)) setInteractiveWithBOOL:interactive];
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TuxkidsTuxblocksCoreLayersImageLayerTintable *typedCopy = (TuxkidsTuxblocksCoreLayersImageLayerTintable *) copy;
  typedCopy.layer = layer_;
  typedCopy.baseImage = baseImage_;
  typedCopy.base = base_;
  typedCopy.top = top_;
  typedCopy.tint_ = tint__;
  typedCopy.tintMap = tintMap_;
}

@end
@implementation TuxkidsTuxblocksCoreLayersImageLayerTintable_$1

@synthesize this$0 = this$0_;
@synthesize val$color = val$color_;

- (void)onSuccessWithId:(id<PlaynCoreImage>)result {
  (void) [((id<PlaynCoreImageLayer>) nil_chk(this$0_.base)) setImageWithPlaynCoreImage:[this$0_ getTintedImageWithJavaLangInteger:[JavaLangInteger valueOfWithInt:val$color_]]];
}

- (void)onFailureWithJavaLangThrowable:(JavaLangThrowable *)cause {
}

- (id)initWithTuxkidsTuxblocksCoreLayersImageLayerTintable:(TuxkidsTuxblocksCoreLayersImageLayerTintable *)outer$
                                                   withInt:(int)capture$0 {
  if ((self = [super init])) {
    this$0_ = outer$;
    val$color_ = capture$0;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TuxkidsTuxblocksCoreLayersImageLayerTintable_$1 *typedCopy = (TuxkidsTuxblocksCoreLayersImageLayerTintable_$1 *) copy;
  typedCopy.this$0 = this$0_;
  typedCopy.val$color = val$color_;
}

@end
@implementation TuxkidsTuxblocksCoreLayersImageLayerTintable_$2

@synthesize this$0 = this$0_;
@synthesize val$baseColor = val$baseColor_;
@synthesize val$tintColor = val$tintColor_;

- (void)onSuccessWithId:(id<PlaynCoreImage>)result {
  (void) [((id<PlaynCoreImageLayer>) nil_chk(this$0_.base)) setImageWithPlaynCoreImage:[this$0_ getTintedImageWithJavaLangInteger:[JavaLangInteger valueOfWithInt:val$baseColor_]]];
  (void) [((id<PlaynCoreImageLayer>) nil_chk(this$0_.top)) setImageWithPlaynCoreImage:[this$0_ getTintedImageWithJavaLangInteger:[JavaLangInteger valueOfWithInt:val$tintColor_]]];
}

- (void)onFailureWithJavaLangThrowable:(JavaLangThrowable *)cause {
}

- (id)initWithTuxkidsTuxblocksCoreLayersImageLayerTintable:(TuxkidsTuxblocksCoreLayersImageLayerTintable *)outer$
                                                   withInt:(int)capture$0
                                                   withInt:(int)capture$1 {
  if ((self = [super init])) {
    this$0_ = outer$;
    val$baseColor_ = capture$0;
    val$tintColor_ = capture$1;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TuxkidsTuxblocksCoreLayersImageLayerTintable_$2 *typedCopy = (TuxkidsTuxblocksCoreLayersImageLayerTintable_$2 *) copy;
  typedCopy.this$0 = this$0_;
  typedCopy.val$baseColor = val$baseColor_;
  typedCopy.val$tintColor = val$tintColor_;
}

@end
