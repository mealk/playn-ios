//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: core/src/main/java/tuxkids/tuxblocks/core/defense/projectile/ConnectionProjectile.java
//
//  Created by Thomas on 7/26/13.
//

#include "playn/core/Image.h"
#include "playn/core/ImageLayer.h"
#include "playn/core/Layer.h"
#include "playn/core/util/Clock.h"
#include "pythagoras/f/Transform.h"
#include "pythagoras/f/Vector.h"
#include "tuxkids/tuxblocks/core/defense/Grid.h"
#include "tuxkids/tuxblocks/core/defense/projectile/ConnectionProjectile.h"
#include "tuxkids/tuxblocks/core/defense/projectile/Projectile.h"
#include "tuxkids/tuxblocks/core/defense/tower/Tower.h"
#include "tuxkids/tuxblocks/core/defense/walker/Walker.h"

@implementation TuxkidsTuxblocksCoreDefenseProjectileConnectionProjectile

@synthesize direction = direction_;
@synthesize timer = timer_;

- (int)duration {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (PythagorasFVector *)sourcePosition {
  return [((TuxkidsTuxblocksCoreDefenseTowerTower *) nil_chk(source__)) projectileStart];
}

- (float)progress {
  return (float) timer_ / [self duration];
}

- (void)placeWithTuxkidsTuxblocksCoreDefenseGrid:(TuxkidsTuxblocksCoreDefenseGrid *)grid
     withTuxkidsTuxblocksCoreDefenseWalkerWalker:(TuxkidsTuxblocksCoreDefenseWalkerWalker *)target
       withTuxkidsTuxblocksCoreDefenseTowerTower:(TuxkidsTuxblocksCoreDefenseTowerTower *)source {
  [super placeWithTuxkidsTuxblocksCoreDefenseGrid:grid withTuxkidsTuxblocksCoreDefenseWalkerWalker:target withTuxkidsTuxblocksCoreDefenseTowerTower:source];
  (void) [((id<PlaynCoreImageLayer>) nil_chk(layer__)) setOriginWithFloat:0 withFloat:[((id<PlaynCoreImageLayer>) nil_chk(layer__)) height] / 2];
}

- (BOOL)doUpdateWithInt:(int)delta {
  timer_ += delta;
  if (timer_ > [self duration]) {
    [self dealDamage];
    return YES;
  }
  return NO;
}

- (void)paintWithPlaynCoreUtilClock:(id<PlaynCoreUtilClock>)clock {
  (void) [((id<PlaynCoreImageLayer>) nil_chk(layer__)) setTranslationWithFloat:((PythagorasFVector *) nil_chk([self sourcePosition])).x_ withFloat:((PythagorasFVector *) nil_chk([self sourcePosition])).y_];
  (void) [((PythagorasFVector *) nil_chk(direction_)) setWithPythagorasFIVector:[((TuxkidsTuxblocksCoreDefenseWalkerWalker *) nil_chk(target__)) position]];
  (void) [((PythagorasFVector *) nil_chk(direction_)) subtractWithPythagorasFIVector:[self sourcePosition] withPythagorasFVector:direction_];
  (void) [((id<PythagorasFTransform>) nil_chk([((id<PlaynCoreImageLayer>) nil_chk(layer__)) transform])) setRotationWithFloat:[((PythagorasFVector *) nil_chk(direction_)) angle]];
  (void) [((id<PythagorasFTransform>) nil_chk([((id<PlaynCoreImageLayer>) nil_chk(layer__)) transform])) setScaleWithFloat:[((PythagorasFVector *) nil_chk(direction_)) length] / [((id<PlaynCoreImage>) nil_chk([((id<PlaynCoreImageLayer>) nil_chk(layer__)) image])) width] withFloat:1.0f];
}

- (id)init {
  if ((self = [super init])) {
    direction_ = [[PythagorasFVector alloc] init];
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TuxkidsTuxblocksCoreDefenseProjectileConnectionProjectile *typedCopy = (TuxkidsTuxblocksCoreDefenseProjectileConnectionProjectile *) copy;
  typedCopy.direction = direction_;
  typedCopy.timer = timer_;
}

@end
