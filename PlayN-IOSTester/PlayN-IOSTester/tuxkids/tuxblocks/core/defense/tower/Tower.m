//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: core/src/main/java/tuxkids/tuxblocks/core/defense/tower/Tower.java
//
//  Created by Thomas on 7/25/13.
//

#include "IOSBooleanArray.h"
#include "IOSObjectArray.h"
#include "java/lang/Math.h"
#include "java/util/ArrayList.h"
#include "java/util/List.h"
#include "playn/core/Canvas.h"
#include "playn/core/CanvasImage.h"
#include "playn/core/Color.h"
#include "playn/core/Graphics.h"
#include "playn/core/Image.h"
#include "playn/core/Layer.h"
#include "playn/core/PlayN.h"
#include "playn/core/util/Clock.h"
#include "pythagoras/f/Vector.h"
#include "pythagoras/i/Point.h"
#include "tripleplay/util/Colors.h"
#include "tuxkids/tuxblocks/core/ImageLayerTintable.h"
#include "tuxkids/tuxblocks/core/defense/DiscreteGridObject.h"
#include "tuxkids/tuxblocks/core/defense/Grid.h"
#include "tuxkids/tuxblocks/core/defense/projectile/Projectile.h"
#include "tuxkids/tuxblocks/core/defense/tower/Tower.h"
#include "tuxkids/tuxblocks/core/defense/tower/TowerType.h"
#include "tuxkids/tuxblocks/core/defense/walker/Walker.h"
#include "tuxkids/tuxblocks/core/utils/CanvasUtils.h"

@implementation TuxkidsTuxblocksCoreDefenseTowerTower

static id<JavaUtilList> TuxkidsTuxblocksCoreDefenseTowerTower_towerBag_;

@synthesize layer_ = layer__;
@synthesize fireTimer = fireTimer_;
@synthesize position_ = position__;
@synthesize id_ = id__;
@synthesize lastTarget_ = lastTarget__;

+ (id<JavaUtilList>)towerBag {
  return TuxkidsTuxblocksCoreDefenseTowerTower_towerBag_;
}

- (int)rows {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (int)cols {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (float)damage {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (int)fireRate {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (float)range {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (TuxkidsTuxblocksCoreDefenseProjectileProjectile *)createProjectile {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (TuxkidsTuxblocksCoreDefenseTowerTower *)copy__ OBJC_METHOD_FAMILY_NONE {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (NSString *)name {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (int)cost {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

- (int)commonness {
  // can't call an abstract method
  [self doesNotRecognizeSelector:_cmd];
  return 0;
}

+ (TuxkidsTuxblocksCoreDefenseTowerTowerTypeEnum *)getTypeByIndexWithInt:(int)index {
  return [((IOSObjectArray *) nil_chk([TuxkidsTuxblocksCoreDefenseTowerTowerTypeEnum values])) objectAtIndex:index];
}

- (float)splashRadius {
  return 0;
}

- (float)baseWidth {
  return [self cols] * [((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid_)) cellSize];
}

- (float)baseHeight {
  return [self rows] * [((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid_)) cellSize];
}

- (float)width {
  return [((TuxkidsTuxblocksCoreImageLayerTintable *) nil_chk(layer__)) width];
}

- (float)height {
  return [((TuxkidsTuxblocksCoreImageLayerTintable *) nil_chk(layer__)) height];
}

- (TuxkidsTuxblocksCoreImageLayerTintable *)layer {
  return layer__;
}

- (id<PlaynCoreLayer>)layerAddable {
  return [((TuxkidsTuxblocksCoreImageLayerTintable *) nil_chk(layer__)) layer];
}

- (PythagorasFVector *)position {
  return position__;
}

- (PythagorasFVector *)projectileStart {
  return position__;
}

- (int)id__ {
  return id__;
}

+ (TuxkidsTuxblocksCoreDefenseTowerTowerTypeEnum *)randomTower {
  return [((id<JavaUtilList>) nil_chk(TuxkidsTuxblocksCoreDefenseTowerTower_towerBag_)) getWithInt:(int) ([JavaLangMath random] * [((id<JavaUtilList>) nil_chk(TuxkidsTuxblocksCoreDefenseTowerTower_towerBag_)) size])];
}

+ (int)towerCount {
  return (int) [((IOSObjectArray *) nil_chk([TuxkidsTuxblocksCoreDefenseTowerTowerTypeEnum values])) count];
}

- (void)addBuffsWithTuxkidsTuxblocksCoreDefenseWalkerWalker:(TuxkidsTuxblocksCoreDefenseWalkerWalker *)walker {
}

- (TuxkidsTuxblocksCoreDefenseWalkerWalker *)lastTarget {
  return lastTarget__;
}

- (void)setLastTargetWithTuxkidsTuxblocksCoreDefenseWalkerWalker:(TuxkidsTuxblocksCoreDefenseWalkerWalker *)target {
  lastTarget__ = target;
}

- (void)setCoordinatesWithPythagorasIPoint:(PythagorasIPoint *)coordinates {
  [self setCoordinatesWithInt:((PythagorasIPoint *) nil_chk(coordinates)).x_ withInt:((PythagorasIPoint *) nil_chk(coordinates)).y_];
}

- (void)setCoordinatesWithInt:(int)row
                      withInt:(int)col {
  [((PythagorasIPoint *) nil_chk(coordinates__)) setLocationWithInt:row withInt:col];
  [((TuxkidsTuxblocksCoreImageLayerTintable *) nil_chk(layer__)) setTranslationWithFloat:col * [((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid_)) cellSize] + ([self baseWidth] - [self width]) / 2 withFloat:row * [((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid_)) cellSize] + ([self baseHeight] - [self height])];
  (void) [((PythagorasFVector *) nil_chk(position__)) setWithFloat:col * [((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid_)) cellSize] + [self width] / 2 withFloat:row * [((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid_)) cellSize] + [self height] / 2];
}

- (void)setDepthWithFloat:(float)depth {
  [((TuxkidsTuxblocksCoreImageLayerTintable *) nil_chk(layer__)) setDepthWithFloat:depth];
}

- (TuxkidsTuxblocksCoreDefenseTowerTower *)previewWithTuxkidsTuxblocksCoreDefenseGrid:(TuxkidsTuxblocksCoreDefenseGrid *)grid {
  if (self.grid != nil) return self;
  self.grid = grid;
  layer__ = [[TuxkidsTuxblocksCoreImageLayerTintable alloc] initWithPlaynCoreImage:[self createImageWithFloat:[((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid)) cellSize] withInt:[TripleplayUtilColors WHITE]]];
  [((TuxkidsTuxblocksCoreImageLayerTintable *) nil_chk(layer__)) setTintWithInt:[((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid)) towerColor]];
  return self;
}

- (TuxkidsTuxblocksCoreDefenseTowerTower *)placeWithTuxkidsTuxblocksCoreDefenseGrid:(TuxkidsTuxblocksCoreDefenseGrid *)grid
                                                               withPythagorasIPoint:(PythagorasIPoint *)coordinates {
  [self placeWithTuxkidsTuxblocksCoreDefenseGrid:grid withFloat:0];
  [self setCoordinatesWithPythagorasIPoint:coordinates];
  for (int i = 0; i < [self rows]; i++) {
    for (int j = 0; j < [self cols]; j++) {
      (*[((IOSBooleanArray *) nil_chk([((IOSObjectArray *) nil_chk([((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid)) getPassability])) objectAtIndex:i + ((PythagorasIPoint *) nil_chk(coordinates)).x_])) booleanRefAtIndex:j + ((PythagorasIPoint *) nil_chk(coordinates)).y_]) = NO;
    }
  }
  return self;
}

- (BOOL)updateWithInt:(int)delta {
  [super updateWithInt:delta];
  int fireRate = [self fireRate];
  if (fireRate > 0 && fireTimer_ > fireRate) {
    if ([self fire]) {
      fireTimer_ -= fireRate;
    }
    else {
      fireTimer_ = fireRate;
    }
  }
  return NO;
}

- (void)paintWithPlaynCoreUtilClock:(id<PlaynCoreUtilClock>)clock {
  fireTimer_ += [((id<PlaynCoreUtilClock>) nil_chk(clock)) dt];
}

- (BOOL)fire {
  return [((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid_)) fireProjectileWithTuxkidsTuxblocksCoreDefenseTowerTower:self];
}

- (BOOL)canPlaceWithInt:(int)row
                withInt:(int)col {
  for (int i = 0; i < [self rows]; i++) {
    for (int j = 0; j < [self cols]; j++) {
      if (![((IOSBooleanArray *) nil_chk([((IOSObjectArray *) nil_chk([((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid_)) getPassability])) objectAtIndex:i + row])) booleanAtIndex:j + col]) return NO;
    }
  }
  return YES;
}

- (id<PlaynCoreImage>)createRadiusImage {
  if ([self range] == 0) return nil;
  float rad = [self range] * [((TuxkidsTuxblocksCoreDefenseGrid *) nil_chk(grid_)) cellSize];
  int color = [PlaynCoreColor rgbWithInt:255 withInt:0 withInt:100];
  return [TuxkidsTuxblocksCoreUtilsCanvasUtils createCircleWithFloat:rad withInt:[PlaynCoreColor withAlphaWithInt:color withInt:50] withFloat:1 withInt:color];
}

- (id<PlaynCoreImage>)createImageWithFloat:(float)cellSize
                                   withInt:(int)color {
  int width = (int) (cellSize * [self cols]), height = (int) (cellSize * [self rows]);
  int padding = (int) (cellSize * 0.1f);
  int rad = (int) ([JavaLangMath minWithInt:width withInt:height] * 0.1f);
  id<PlaynCoreCanvasImage> image = [((id<PlaynCoreGraphics>) nil_chk([PlaynCorePlayN graphics])) createImageWithFloat:width withFloat:height];
  (void) [((id<PlaynCoreCanvas>) nil_chk([((id<PlaynCoreCanvasImage>) nil_chk(image)) canvas])) setFillColorWithInt:color];
  (void) [((id<PlaynCoreCanvas>) nil_chk([((id<PlaynCoreCanvasImage>) nil_chk(image)) canvas])) fillRoundRectWithFloat:padding withFloat:padding withFloat:[((id<PlaynCoreCanvasImage>) nil_chk(image)) width] - padding * 2 withFloat:[((id<PlaynCoreCanvasImage>) nil_chk(image)) height] - padding * 2 withFloat:rad];
  (void) [((id<PlaynCoreCanvas>) nil_chk([((id<PlaynCoreCanvasImage>) nil_chk(image)) canvas])) setStrokeColorWithInt:[TripleplayUtilColors BLACK]];
  (void) [((id<PlaynCoreCanvas>) nil_chk([((id<PlaynCoreCanvasImage>) nil_chk(image)) canvas])) strokeRoundRectWithFloat:padding withFloat:padding withFloat:[((id<PlaynCoreCanvasImage>) nil_chk(image)) width] - padding * 2 - 1 withFloat:[((id<PlaynCoreCanvasImage>) nil_chk(image)) height] - padding * 2 - 1 withFloat:rad];
  return image;
}

- (id)init {
  if ((self = [super init])) {
    position__ = [[PythagorasFVector alloc] init];
  }
  return self;
}

+ (void)initialize {
  if (self == [TuxkidsTuxblocksCoreDefenseTowerTower class]) {
    {
      TuxkidsTuxblocksCoreDefenseTowerTower_towerBag_ = [[JavaUtilArrayList alloc] init];
      {
        IOSObjectArray *a__ = [TuxkidsTuxblocksCoreDefenseTowerTowerTypeEnum values];
        int n__ = (int) [((IOSObjectArray *) nil_chk(a__)) count];
        for (int i__ = 0; i__ < n__; i__++) {
          TuxkidsTuxblocksCoreDefenseTowerTowerTypeEnum *type = [((IOSObjectArray *) nil_chk(a__)) objectAtIndex:i__];
          for (int i = 0; i < [((TuxkidsTuxblocksCoreDefenseTowerTower *) nil_chk([((TuxkidsTuxblocksCoreDefenseTowerTowerTypeEnum *) nil_chk(type)) instance])) commonness]; i++) [((id<JavaUtilList>) nil_chk(TuxkidsTuxblocksCoreDefenseTowerTower_towerBag_)) addWithId:type];
        }
      }
    }
  }
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  TuxkidsTuxblocksCoreDefenseTowerTower *typedCopy = (TuxkidsTuxblocksCoreDefenseTowerTower *) copy;
  typedCopy.layer_ = layer__;
  typedCopy.fireTimer = fireTimer_;
  typedCopy.position_ = position__;
  typedCopy.id_ = id__;
  typedCopy.lastTarget_ = lastTarget__;
}

@end
