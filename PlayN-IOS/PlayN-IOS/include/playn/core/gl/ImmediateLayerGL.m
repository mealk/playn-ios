//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: playn/core/gl/ImmediateLayerGL.java
//
//  Created by Thomas on 7/25/13.
//

#include "IOSClass.h"
#include "java/lang/Math.h"
#include "playn/core/AbstractLayer.h"
#include "playn/core/Graphics.h"
#include "playn/core/ImmediateLayer.h"
#include "playn/core/InternalTransform.h"
#include "playn/core/PlayN.h"
#include "playn/core/Surface.h"
#include "playn/core/Tint.h"
#include "playn/core/gl/GLContext.h"
#include "playn/core/gl/GLShader.h"
#include "playn/core/gl/ImmediateLayerGL.h"
#include "playn/core/gl/LayerGL.h"
#include "pythagoras/f/Point.h"
#include "pythagoras/f/Transform.h"
#include "pythagoras/f/Vector.h"

@implementation PlaynCoreGlImmediateLayerGL

@synthesize surface = surface_;
@synthesize renderer_ = renderer__;

- (id)initWithPlaynCoreGlGLContext:(PlaynCoreGlGLContext *)ctx
withPlaynCoreImmediateLayer_Renderer:(id<PlaynCoreImmediateLayer_Renderer>)renderer {
  return [self initPlaynCoreGlImmediateLayerGLWithPlaynCoreGlGLContext:ctx withPlaynCoreImmediateLayer_Renderer:renderer withPlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL:[[PlaynCoreGlImmediateLayerGL_$1 alloc] initWithPlaynCoreGlGLContext:ctx]];
}

- (id<PlaynCoreImmediateLayer_Renderer>)renderer {
  return renderer__;
}

- (id)initPlaynCoreGlImmediateLayerGLWithPlaynCoreGlGLContext:(PlaynCoreGlGLContext *)ctx
                         withPlaynCoreImmediateLayer_Renderer:(id<PlaynCoreImmediateLayer_Renderer>)renderer
           withPlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL:(PlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL *)surface {
  if ((self = [super initWithPlaynCoreGlGLContext:ctx])) {
    self.surface = surface;
    self.renderer_ = renderer;
  }
  return self;
}

- (id)initWithPlaynCoreGlGLContext:(PlaynCoreGlGLContext *)ctx
withPlaynCoreImmediateLayer_Renderer:(id<PlaynCoreImmediateLayer_Renderer>)renderer
withPlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL:(PlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL *)surface {
  return [self initPlaynCoreGlImmediateLayerGLWithPlaynCoreGlGLContext:ctx withPlaynCoreImmediateLayer_Renderer:renderer withPlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL:surface];
}

- (void)paintWithPlaynCoreInternalTransform:(id<PlaynCoreInternalTransform>)curTransform
                                    withInt:(int)curTint
                    withPlaynCoreGlGLShader:(PlaynCoreGlGLShader *)curShader {
  if (![self visible]) return;
  id<PlaynCoreInternalTransform> xform = [self localTransformWithPlaynCoreInternalTransform:curTransform];
  (void) [((id<PlaynCoreInternalTransform>) nil_chk([((PlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL *) nil_chk(surface_)) topTransform])) setWithPythagorasFTransform:xform];
  if (tint__ != PlaynCoreTint_NOOP_TINT) curTint = [PlaynCoreTint combineWithInt:curTint withInt:tint__];
  (void) [((PlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL *) nil_chk(surface_)) setTintWithInt:curTint];
  (void) [((PlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL *) nil_chk(surface_)) setShaderWithPlaynCoreGlGLShader:(shader_ == nil) ? curShader : shader_];
  [self renderWithPlaynCoreInternalTransform:xform];
  (void) [((PlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL *) nil_chk(surface_)) setShaderWithPlaynCoreGlGLShader:nil];
}

- (void)renderWithPlaynCoreInternalTransform:(id<PlaynCoreInternalTransform>)xform {
  [((id<PlaynCoreImmediateLayer_Renderer>) nil_chk(renderer__)) renderWithPlaynCoreSurface:surface_];
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  PlaynCoreGlImmediateLayerGL *typedCopy = (PlaynCoreGlImmediateLayerGL *) copy;
  typedCopy.surface = surface_;
  typedCopy.renderer_ = renderer__;
}

@end
@implementation PlaynCoreGlImmediateLayerGL_Clipped

@synthesize width_ = width__;
@synthesize height_ = height__;
@synthesize pos = pos_;
@synthesize size = size_;

- (id)initWithPlaynCoreGlGLContext:(PlaynCoreGlGLContext *)ctx
                           withInt:(int)width
                           withInt:(int)height
withPlaynCoreImmediateLayer_Renderer:(id<PlaynCoreImmediateLayer_Renderer>)renderer {
  if ((self = [super initWithPlaynCoreGlGLContext:ctx withPlaynCoreImmediateLayer_Renderer:renderer withPlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL:[[PlaynCoreGlImmediateLayerGL_Clipped_$1 alloc] initWithPlaynCoreGlGLContext:ctx withInt:width withInt:height]])) {
    pos_ = [[PythagorasFPoint alloc] init];
    size_ = [[PythagorasFVector alloc] init];
    self.width_ = width;
    self.height_ = height;
  }
  return self;
}

- (float)width {
  return width__;
}

- (float)height {
  return height__;
}

- (float)scaledWidth {
  return [self scaleX] * [self width];
}

- (float)scaledHeight {
  return [self scaleY] * [self height];
}

- (void)renderWithPlaynCoreInternalTransform:(id<PlaynCoreInternalTransform>)xform {
  (void) [((id<PlaynCoreInternalTransform>) nil_chk(xform)) translateWithFloat:originX__ withFloat:originY__];
  (void) [((id<PlaynCoreInternalTransform>) nil_chk(xform)) transformWithPythagorasFIPoint:[((PythagorasFPoint *) nil_chk(pos_)) setWithFloat:-originX__ withFloat:-originY__] withPythagorasFPoint:pos_];
  (void) [((id<PlaynCoreInternalTransform>) nil_chk(xform)) transformWithPythagorasFIVector:[((PythagorasFVector *) nil_chk(size_)) setWithFloat:width__ withFloat:height__] withPythagorasFVector:size_];
  (void) [((id<PlaynCoreInternalTransform>) nil_chk(xform)) translateWithFloat:-originX__ withFloat:-originY__];
  [((PlaynCoreGlGLContext *) nil_chk(ctx_)) startClippedWithInt:(int) ((PythagorasFPoint *) nil_chk(pos_)).x_ withInt:(int) ((PythagorasFPoint *) nil_chk(pos_)).y_ withInt:(int) [JavaLangMath absWithFloat:((PythagorasFVector *) nil_chk(size_)).x_] withInt:(int) [JavaLangMath absWithFloat:((PythagorasFVector *) nil_chk(size_)).y_]];
  @try {
    [super renderWithPlaynCoreInternalTransform:xform];
  }
  @finally {
    [((PlaynCoreGlGLContext *) nil_chk(ctx_)) endClipped];
  }
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  PlaynCoreGlImmediateLayerGL_Clipped *typedCopy = (PlaynCoreGlImmediateLayerGL_Clipped *) copy;
  typedCopy.width_ = width__;
  typedCopy.height_ = height__;
  typedCopy.pos = pos_;
  typedCopy.size = size_;
}

@end
@implementation PlaynCoreGlImmediateLayerGL_ImmediateSurfaceGL

- (id)initWithPlaynCoreGlGLContext:(PlaynCoreGlGLContext *)ctx {
  return [super initWithPlaynCoreGlGLContext:ctx];
}

- (void)bindFramebuffer {
}

@end
@implementation PlaynCoreGlImmediateLayerGL_Clipped_$1

@synthesize val$width = val$width_;
@synthesize val$height = val$height_;

- (float)width {
  return val$width_;
}

- (float)height {
  return val$height_;
}

- (id)initWithPlaynCoreGlGLContext:(PlaynCoreGlGLContext *)arg$0
                           withInt:(int)capture$0
                           withInt:(int)capture$1 {
  if ((self = [super initWithPlaynCoreGlGLContext:arg$0])) {
    val$width_ = capture$0;
    val$height_ = capture$1;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  PlaynCoreGlImmediateLayerGL_Clipped_$1 *typedCopy = (PlaynCoreGlImmediateLayerGL_Clipped_$1 *) copy;
  typedCopy.val$width = val$width_;
  typedCopy.val$height = val$height_;
}

@end
@implementation PlaynCoreGlImmediateLayerGL_$1

- (float)width {
  return [((id<PlaynCoreGraphics>) nil_chk([PlaynCorePlayN graphics])) width];
}

- (float)height {
  return [((id<PlaynCoreGraphics>) nil_chk([PlaynCorePlayN graphics])) height];
}

- (id)initWithPlaynCoreGlGLContext:(PlaynCoreGlGLContext *)arg$0 {
  return [super initWithPlaynCoreGlGLContext:arg$0];
}

@end
