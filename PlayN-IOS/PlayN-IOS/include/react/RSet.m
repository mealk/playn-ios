//
//  Generated by the J2ObjC translator.  DO NOT EDIT!
//  source: react/RSet.java
//
//  Created by Thomas on 7/10/13.
//

#import "IOSObjectArray.h"
#import "java/lang/Boolean.h"
#import "java/lang/Integer.h"
#import "java/lang/NullPointerException.h"
#import "java/lang/Throwable.h"
#import "java/util/ArrayList.h"
#import "java/util/Collection.h"
#import "java/util/HashSet.h"
#import "java/util/Iterator.h"
#import "java/util/List.h"
#import "java/util/Set.h"
#import "react/Connection.h"
#import "react/Cons.h"
#import "react/MultiFailureException.h"
#import "react/RSet.h"
#import "react/Reactor.h"
#import "react/Value.h"
#import "react/ValueView.h"

@implementation ReactRSet

@synthesize _impl = _impl_;
@synthesize _sizeView = _sizeView_;

+ (ReactRSet *)create {
  return ((ReactRSet *) [ReactRSet createWithJavaUtilSet:[[JavaUtilHashSet alloc] init]]);
}

+ (ReactRSet *)createWithJavaUtilSet:(id<JavaUtilSet>)impl {
  return [[ReactRSet alloc] initWithJavaUtilSet:impl];
}

- (id)initWithJavaUtilSet:(id<JavaUtilSet>)impl {
  if ((self = [super init])) {
    _impl_ = impl;
  }
  return self;
}

- (id<ReactConnection>)connectWithReactRSet_Listener:(ReactRSet_Listener *)listener {
  ReactRSet_Listener *casted = (ReactRSet_Listener *) listener;
  return ((ReactCons *) [self addConnectionWithId:casted]);
}

- (void)disconnectWithReactRSet_Listener:(ReactRSet_Listener *)listener {
  ReactRSet_Listener *casted = (ReactRSet_Listener *) listener;
  [self removeConnectionWithId:casted];
}

- (BOOL)addForceWithId:(id)elem {
  [self checkMutate];
  BOOL added = [((id<JavaUtilSet>) NIL_CHK(_impl_)) addWithId:elem];
  [self emitAddWithId:elem];
  return added;
}

- (BOOL)removeForceWithId:(id)elem {
  [self checkMutate];
  BOOL removed = [((id<JavaUtilSet>) NIL_CHK(_impl_)) removeWithId:elem];
  [self emitRemoveWithId:elem];
  return removed;
}

- (id<ReactValueView>)containsViewWithId:(id)elem {
  if (elem == nil) @throw [[JavaLangNullPointerException alloc] initWithNSString:@"Must supply non-null 'elem'."];
  return [[ReactRSet_$1 alloc] initWithReactRSet:self withId:elem];
}

- (id<ReactValueView>)sizeView {
  @synchronized(self) {
    {
      if (_sizeView_ == nil) {
        _sizeView_ = ((ReactValue *) [ReactValue createWithId:[JavaLangInteger valueOfWithInt:[self size]]]);
        (void) [self connectWithReactRSet_Listener:[[ReactRSet_$2 alloc] initWithReactRSet:self]];
      }
      return _sizeView_;
    }
  }
}

- (int)size {
  return [((id<JavaUtilSet>) NIL_CHK(_impl_)) size];
}

- (BOOL)isEmpty {
  return [((id<JavaUtilSet>) NIL_CHK(_impl_)) isEmpty];
}

- (BOOL)containsWithId:(id)key {
  return [((id<JavaUtilSet>) NIL_CHK(_impl_)) containsWithId:key];
}

- (BOOL)addWithId:(id)elem {
  [self checkMutate];
  if (![((id<JavaUtilSet>) NIL_CHK(_impl_)) addWithId:elem]) return NO;
  [self emitAddWithId:elem];
  return YES;
}

- (BOOL)removeWithId:(id)rawElem {
  [self checkMutate];
  if (![((id<JavaUtilSet>) NIL_CHK(_impl_)) removeWithId:rawElem]) return NO;
  id elem = (id) rawElem;
  [self emitRemoveWithId:elem];
  return YES;
}

- (BOOL)containsAllWithJavaUtilCollection:(id<JavaUtilCollection>)coll {
  return [((id<JavaUtilSet>) NIL_CHK(_impl_)) containsAllWithJavaUtilCollection:coll];
}

- (BOOL)addAllWithJavaUtilCollection:(id<JavaUtilCollection>)coll {
  BOOL modified = NO;
  {
    id<JavaUtilIterator> iter__ = ((id<JavaUtilIterator>) [((id<JavaUtilCollection>) NIL_CHK(coll)) iterator]);
    while ([((id<JavaUtilIterator>) NIL_CHK(iter__)) hasNext]) {
      id elem = [((id<JavaUtilIterator>) NIL_CHK(iter__)) next];
      modified |= [self addWithId:elem];
    }
  }
  return modified;
}

- (BOOL)retainAllWithJavaUtilCollection:(id<JavaUtilCollection>)coll {
  BOOL modified = NO;
  for (id<JavaUtilIterator> iter = [self iterator]; [((id<JavaUtilIterator>) NIL_CHK(iter)) hasNext]; ) {
    if (![((id<JavaUtilCollection>) NIL_CHK(coll)) containsWithId:[((id<JavaUtilIterator>) NIL_CHK(iter)) next]]) {
      [((id<JavaUtilIterator>) NIL_CHK(iter)) remove];
      modified = YES;
    }
  }
  return modified;
}

- (BOOL)removeAllWithJavaUtilCollection:(id<JavaUtilCollection>)coll {
  BOOL modified = NO;
  for (id<JavaUtilIterator> iter = [((id<JavaUtilCollection>) NIL_CHK(coll)) iterator]; [((id<JavaUtilIterator>) NIL_CHK(iter)) hasNext]; ) {
    modified |= [self removeWithId:[((id<JavaUtilIterator>) NIL_CHK(iter)) next]];
  }
  return modified;
}

- (void)clear {
  [self checkMutate];
  id<JavaUtilList> elems = [[JavaUtilArrayList alloc] initWithJavaUtilCollection:_impl_];
  [((id<JavaUtilSet>) NIL_CHK(_impl_)) clear];
  {
    id<JavaUtilIterator> iter__ = ((id<JavaUtilIterator>) [((id<JavaUtilList>) NIL_CHK(elems)) iterator]);
    while ([((id<JavaUtilIterator>) NIL_CHK(iter__)) hasNext]) {
      id elem = [((id<JavaUtilIterator>) NIL_CHK(iter__)) next];
      [self emitRemoveWithId:elem];
    }
  }
}

- (id<JavaUtilIterator>)iterator {
  id<JavaUtilIterator> iiter = ((id<JavaUtilIterator>) [((id<JavaUtilSet>) NIL_CHK(_impl_)) iterator]);
  return [[ReactRSet_$3 alloc] initWithReactRSet:self withJavaUtilIterator:iiter];
}

- (IOSObjectArray *)toArray {
  return [((id<JavaUtilSet>) NIL_CHK(_impl_)) toArray];
}

- (IOSObjectArray *)toArrayWithNSObjectArray:(IOSObjectArray *)array {
  return [((id<JavaUtilSet>) NIL_CHK(_impl_)) toArrayWithNSObjectArray:array];
}

- (NSUInteger)hash {
  return [((id<JavaUtilSet>) NIL_CHK(_impl_)) hash];
}

- (BOOL)isEqual:(id)other {
  return ([other conformsToProtocol: @protocol(JavaUtilSet)]) ? [((id<JavaUtilSet>) NIL_CHK(_impl_)) isEqual:other] : NO;
}

- (NSString *)description {
  return [NSString stringWithFormat:@"RSet%@", _impl_];
}

- (void)emitAddWithId:(id)elem {
  [self notifyAddWithId:elem];
}

- (void)notifyAddWithId:(id)elem {
  ReactCons *lners = ((ReactCons *) [self prepareNotify]);
  ReactMultiFailureException *error = nil;
  @try {
    for (ReactCons * cons = lners; cons != nil; cons = ((ReactCons *) NIL_CHK(cons)).next) {
      @try {
        [((ReactRSet_Listener *) NIL_CHK(cons.listener)) onAddWithId:elem];
      }
      @catch (JavaLangThrowable *t) {
        if (error == nil) error = [[ReactMultiFailureException alloc] init];
        [((ReactMultiFailureException *) NIL_CHK(error)) addFailureWithJavaLangThrowable:t];
      }
      if (((ReactCons *) NIL_CHK(cons)).oneShot) [((ReactCons *) NIL_CHK(cons)) disconnect];
    }
  }
  @finally {
    [self finishNotifyWithReactCons:lners];
  }
  if (error != nil) [error trigger];
}

- (void)emitRemoveWithId:(id)elem {
  [self notifyRemoveWithId:elem];
}

- (void)notifyRemoveWithId:(id)elem {
  ReactCons *lners = ((ReactCons *) [self prepareNotify]);
  ReactMultiFailureException *error = nil;
  @try {
    for (ReactCons * cons = lners; cons != nil; cons = ((ReactCons *) NIL_CHK(cons)).next) {
      @try {
        [((ReactRSet_Listener *) NIL_CHK(cons.listener)) onRemoveWithId:elem];
      }
      @catch (JavaLangThrowable *t) {
        if (error == nil) error = [[ReactMultiFailureException alloc] init];
        [((ReactMultiFailureException *) NIL_CHK(error)) addFailureWithJavaLangThrowable:t];
      }
      if (((ReactCons *) NIL_CHK(cons)).oneShot) [((ReactCons *) NIL_CHK(cons)) disconnect];
    }
  }
  @finally {
    [self finishNotifyWithReactCons:lners];
  }
  if (error != nil) [error trigger];
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  ReactRSet *typedCopy = (ReactRSet *) copy;
  typedCopy._impl = _impl_;
  typedCopy._sizeView = _sizeView_;
}

@end
@implementation ReactRSet_$1

@synthesize this$0 = this$0_;
@synthesize val$elem = val$elem_;

- (JavaLangBoolean *)get {
  return [JavaLangBoolean valueOfWithBOOL:[this$0_ containsWithId:val$elem_]];
}

- (id<ReactConnection>)connect {
  return [this$0_ connectWithReactRSet_Listener:[[ReactRSet_$1_$1 alloc] initWithReactRSet_$1:self]];
}

- (id)initWithReactRSet:(ReactRSet *)outer$
                 withId:(id)capture$0 {
  if ((self = [super init])) {
    this$0_ = outer$;
    val$elem_ = capture$0;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  ReactRSet_$1 *typedCopy = (ReactRSet_$1 *) copy;
  typedCopy.this$0 = this$0_;
  typedCopy.val$elem = val$elem_;
}

@end
@implementation ReactRSet_Listener

- (void)onAddWithId:(id)elem {
}

- (void)onRemoveWithId:(id)elem {
}

- (id)init {
  return [super init];
}

@end
@implementation ReactRSet_$1_$1

@synthesize this$0 = this$0_;

- (void)onAddWithId:(id)aelem {
  if ([NIL_CHK(this$0_.val$elem) isEqual:aelem]) [this$0_ notifyChangeWithId:[JavaLangBoolean valueOfWithBOOL:YES] withId:[JavaLangBoolean valueOfWithBOOL:NO]];
}

- (void)onRemoveWithId:(id)relem {
  if ([NIL_CHK(this$0_.val$elem) isEqual:relem]) [this$0_ notifyChangeWithId:[JavaLangBoolean valueOfWithBOOL:NO] withId:[JavaLangBoolean valueOfWithBOOL:YES]];
}

- (id)initWithReactRSet_$1:(ReactRSet_$1 *)outer$ {
  if ((self = [super init])) {
    this$0_ = outer$;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  ReactRSet_$1_$1 *typedCopy = (ReactRSet_$1_$1 *) copy;
  typedCopy.this$0 = this$0_;
}

@end
@implementation ReactRSet_$2

@synthesize this$0 = this$0_;

- (void)onAddWithId:(id)elem {
  (void) [((ReactValue *) NIL_CHK(this$0_._sizeView)) updateWithId:[JavaLangInteger valueOfWithInt:[this$0_ size]]];
}

- (void)onRemoveWithId:(id)elem {
  (void) [((ReactValue *) NIL_CHK(this$0_._sizeView)) updateWithId:[JavaLangInteger valueOfWithInt:[this$0_ size]]];
}

- (id)initWithReactRSet:(ReactRSet *)outer$ {
  if ((self = [super init])) {
    this$0_ = outer$;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  ReactRSet_$2 *typedCopy = (ReactRSet_$2 *) copy;
  typedCopy.this$0 = this$0_;
}

@end
@implementation ReactRSet_$3

@synthesize this$0 = this$0_;
@synthesize _current = _current_;
@synthesize val$iiter = val$iiter_;

- (BOOL)hasNext {
  return [((id<JavaUtilIterator>) NIL_CHK(val$iiter_)) hasNext];
}

- (id)next {
  return (_current_ = [((id<JavaUtilIterator>) NIL_CHK(val$iiter_)) next]);
}

- (void)remove {
  [this$0_ checkMutate];
  [((id<JavaUtilIterator>) NIL_CHK(val$iiter_)) remove];
  [this$0_ emitRemoveWithId:_current_];
}

- (id)initWithReactRSet:(ReactRSet *)outer$
   withJavaUtilIterator:(id<JavaUtilIterator>)capture$0 {
  if ((self = [super init])) {
    this$0_ = outer$;
    val$iiter_ = capture$0;
  }
  return self;
}

- (void)copyAllPropertiesTo:(id)copy {
  [super copyAllPropertiesTo:copy];
  ReactRSet_$3 *typedCopy = (ReactRSet_$3 *) copy;
  typedCopy.this$0 = this$0_;
  typedCopy._current = _current_;
  typedCopy.val$iiter = val$iiter_;
}

@end
